<div render-lucide-icons>
  <div class="flex justify-between items-center mb-8">
    <div><h1 class="text-3xl font-bold tracking-tight">Controle de Taxas</h1><p class="text-muted-foreground">{{ isManager ? 'Gerencie as taxas de todas as unidades' : 'Consulte o histórico de taxas da sua unidade' }}</p></div>
    <button ng-if="isManager" ng-click="openNewFeeModal()" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"><i data-lucide="plus" class="mr-2 h-4 w-4"></i><span>Lançar Nova Taxa</span></button>
  </div>
  <div class="mb-6 rounded-lg border bg-card p-4">
    <div class="flex flex-wrap items-end gap-4">
      <div class="flex-1 min-w-[150px]"><label for="startDate" class="text-sm font-medium">De</label><input ng-model="filter.startDate" id="startDate" type="date" class="flex h-10 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm mt-1" /></div>
      <div class="flex-1 min-w-[150px]"><label for="endDate" class="text-sm font-medium">Até</label><input ng-model="filter.endDate" id="endDate" type="date" class="flex h-10 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm mt-1" /></div>
      <button ng-click="applyDateFilter()" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"><i data-lucide="filter" class="mr-2 h-4 w-4"></i><span>Filtrar</span></button>
    </div>
  </div>

  <div ng-if="isManager">
    <div class="rounded-lg border bg-card text-card-foreground shadow-sm">
      <div class="p-6"><h3 class="text-2xl font-semibold">Situação por Unidade</h3></div>
      <div class="p-6 pt-0"><div class="relative w-full overflow-auto">
        <table class="w-full caption-bottom text-sm">
          <thead><tr class="border-b"><th class="h-12 px-4 text-left">Unidade</th><th class="h-12 px-4 text-left">Proprietário</th><th class="h-12 px-4 text-left">Status Financeiro</th><th class="h-12 px-4 text-left">Ações</th></tr></thead>
          <tbody>
            <tr ng-repeat="unit in displayedData" class="border-b">
              <td class="p-4 font-medium">Apto {{ unit.apt }}</td>
              <td class="p-4">{{ unit.owner }}</td>
              <td class="p-4"><span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold" ng-class="getUnitStatus(unit).class">{{ getUnitStatus(unit).text }}</span></td>
              <td class="p-4"><button ng-click="openUnitFeeDetailsModal(unit)" class="inline-flex items-center justify-center rounded-md text-sm font-medium border border-input h-9 px-3 hover:bg-accent">Ver Detalhes</button></td>
            </tr>
          </tbody>
        </table>
      </div></div>
    </div>
  </div>

  <div ng-if="!isManager">
    <div class="rounded-lg border bg-card text-card-foreground shadow-sm">
      <div class="p-6"><h3 class="text-2xl font-semibold leading-none tracking-tight">Histórico de Taxas</h3></div>
      <div class="p-6 pt-0"><div class="relative w-full overflow-auto">
        <table class="w-full caption-bottom text-sm">
          <thead><tr class="border-b"><th class="h-12 px-4 text-left">Descrição</th><th class="h-12 px-4 text-left">Valor</th><th class="h-12 px-4 text-left">Vencimento</th><th class="h-12 px-4 text-left">Status</th><th class="h-12 px-4 text-left">Ações</th></tr></thead>
          <tbody>
            <tr ng-repeat="fee in displayedData" class="border-b transition-colors hover:bg-muted/50">
              <td class="p-4 align-middle font-medium">{{ fee.description }}</td>
              <td class="p-4 align-middle">R$ {{ fee.amount.toFixed(2) }}</td>
              <td class="p-4 align-middle">{{ fee.dueDate }}</td>
              <td class="p-4 align-middle"><span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ring-1 ring-inset" ng-class="fee.statusClass">{{ fee.status }}</span></td>
              <td class="p-4 align-middle"><button ng-click="openFeeDetailsModal(fee)" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium h-8 w-8 p-0 hover:bg-accent"><i data-lucide="eye" class="h-4 w-4"></i></button></td>
            </tr>
          </tbody>
        </table>
      </div></div>
    </div>
  </div>

  <div ng-show="modals.newFee.isOpen"></div>
  <div ng-show="modals.feeDetail.isOpen"></div>
  <div ng-show="modals.unitFeeDetail.isOpen"></div>
</div>